var steps=0,stepper=0;function setSteps(a){steps=a;stepper=100/steps}function setStep(a){clearErrors();$(".progress-bar").css("width",stepper*a+"%");$(".step").hide();$("#step-"+a).show()}
function validateStep(a){clearErrors();switch(a){case 1:validatePortal($("#portal-name").val());validateRole($("#role").val());ValidateUserOwner($("#user-lookup-value").val());break;case 2:"Client"==$("#role").val()?ValidateReferenceOrName($("#reference-code").val(),$("#firstname").val(),$("#lastname").val(),$("#emailaddress").val()):ValidateFullUser($("#firstname").val(),$("#lastname").val(),$("#emailaddress").val()),ValidateUserDateOfBirth($("#dob-formatted").val()),validateTelephoneNumber($("#phone").val())||
errors.push("Please provide a valid telephone number"),validateTelephoneNumber($("#mobile").val())||errors.push("Please provide a valid mobile number")}0==errors.length?setStep(a+1):displayErrors()}function validatePortal(a){"none"==a&&errors.push("You must select a Portal to continue")}function validateRole(a){"none"==a&&errors.push("You must select a role to continue or there are is insufficient quota to create a new Person")}
function ValidateUserOwner(a){""!=a&&null!=a||errors.push("You must select an owner for this user")}function ValidateFullUser(a,b,c){""!=a&&null!=a||errors.push("You must provide the first name for this user");""!=b&&null!=b||errors.push("You must provide the last name for this user");validateEmail(c)||errors.push("Please enter a valid email address")}
function ValidateReferenceOrName(a,b,c,d){""!=a||""!=b&&""!=c||errors.push("You must provide either a Reference or a First Name and Last Name");""!=d&&(validateEmail(d)||errors.push("Please enter a valid email address"))}function ValidateUserDateOfBirth(a){""!=a&&(a=new moment(a,"DD-MM-YYYY"),a.isValid()?(18>moment().diff(a,"years")||120<moment().diff(a,"years"))&&errors.push("User must be aged 18 or over"):errors.push("Invalid date of birth entered (DD/MM/YYYY)"))}
function getEmailInUse(a,b,c){return $.ajax({url:"/callback/portalEmailInUse",type:"post",dataType:"json",cache:!1,data:{portalId:a,email:b,userId:c}})}function CreateUser(){return $.ajax({url:"/people/ajaxcreateuser",type:"post",dataType:"json",cache:!1,data:$("#user-form").serialize()})};
